---
title: "esm_204_hw3"
author: "Oswaldo Felix, Derek Nguyen"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(tidyr)
library(ggplot2)
library(janitor)
library(gridExtra)
```

```{r}
gas_data <- read_csv("gas_data.csv") %>% 
  clean_names()
```



```{r}
plot_low <- ggplot(data = gas_data, aes(x = price_dollars, y = q_low_gallons)) +
  geom_point()+
  theme_minimal()
plot_low

plot_high <- ggplot(data = gas_data, aes(x = price_dollars, y = q_high_gallons)) +
  geom_point() +
  theme_minimal()
plot_high

grid.arrange(plot_low, plot_high, ncol = 2, top = "Demand for High and Low Consumers")
```

```{r}
# regression models for high and low income consumers (demand curves)

# Low 
lm_low <- lm(price_dollars ~ q_low_gallons, data = gas_data)
lm_low

# high
lm_high <- lm(price_dollars ~ q_high_gallons, data = gas_data)
lm_high
```

```{r}
predict_demand <- function(q, model){
  b0 <- model$coefficients[1]
  b1 <- model$coefficients[2]
  predicted_demand <- b0 + b1*q
  return(predicted_demand)
}

quantity = seq(1:50)
predict_demand(quantity, lm_high)


```




















